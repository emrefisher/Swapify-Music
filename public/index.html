<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-music-developer-token" content="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ijk2NTVYWEsyVEMifQ.eyJpYXQiOjE1NzUyMjI5NTQsImV4cCI6MTU5MDc3NDk1NCwiaXNzIjoiMzhVTjJLODg3OSJ9.JX4gbQPhHqzhux9Fsl8XD39_whOkCZ-ERNE7HBBHSzxHFFg9F28y35JI3N1ZAn6sye1g3zEYH_O2M7JpvX8JpQ">
 <meta name="apple-music-app-name" content="Swapify Music">
 <meta name="apple-music-app-build" content="1978.4.1">
<link rel="stylesheet" type="text/css" href="swapify.css">
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
   integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Popper.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
   integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

<!-- Bootstrap JavaScript -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
   integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<!-- Apple MusicKit Include -->
<script src="https://js-cdn.music.apple.com/musickit/v1/musickit.js"></script>


<script type="text/javascript">
        var redirect_uri = "http://localhost:8080";

        function createMusik(dev_token) {
                var music = MusicKit.getInstance();
        }

        function loginSpotify() {
                var redirect_uri = "http://localhost:8080/redirect";
                var client_id = "60721dc9caed46d29fc97b701636ca48";
                window.location="https://accounts.spotify.com/authorize?redirect_uri=" + redirect_uri + "&response_type=code&client_id=" + client_id;
        }

        function addButtons() {
                document.getElementById("search_bar").innerHTML += "<br><button onclick='transferAll()'>Transfer All</button><button onclick='transfer()'>Transfer</button>"
        }

        function logIn_Apple() {
                var xhr = new XMLHttpRequest();
                xhr.addEventListener("load", tokenHander);
                xhr.open("GET", "http://localhost:8080/logInApple")
                xhr.send();
        }

        function responseRecievedHandler() {
                if (this.status==200) {
                        console.log("success: " + this.response);
                } else {
                        console.log("failure: " + this.response);
                }
        }

        function tokenHander() {
                if (this.status == 200) {
                        createMusik(this.response);
                } else {
                        console.log('failure: ' + this.response);
                }
        }

        function check4SpotAuth() {
                var urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get("access_token")) {
                        var access_token = urlParams.get("access_token");
                        var button = document.getElementById("spotify_button")
                        button.innerHTML="&#10004;"
                        button.style.backgroundColor="lightgreen";
                        button.style.borderRadius="50px";
                        button.removeAttribute('onclick');
                } else {
                        return 0;
                }
        }


</script>
<title>Swapify Music</title>
<head>
        <h1 id="logo">Swapify Music</h1>
</head>
<body onload="check4SpotAuth()">
        <section id="search_bar">
                <input id="bar" type="text"><br><br>
        </section>
        <section id="logins">
                <div id="apple-login" class="container-fluid">
                        <h1>Step 2: Authorize with Apple</h1><br><br>
                        <img id="apple_logo" src="apple_logo.png"/>
                        <!--<button id="apple_button" onclick="logIn_Apple()"><a href="http://localhost:8080/redirect">Log In To Apple Music</a></button>-->
                        <button class="apple_button_1" id="apple-music-authorize" onclick="logIn_Apple()">Authorize</button>
                        <button class="apple_button_2" id="apple-music-unauthorize">Unauthorize</button>
                </div>
                <div id="spotify-login" class="container-fluid">
                        <h1>Step 1: Authorize with Spotify</h1><br><br>
                        <img id="spotify_logo" src="spotify_logo.png"/>
                        <button id="spotify_button" onclick="loginSpotify()">Authorize</button>
                </div>
        </section>
        <section id="info">
                <div>
                </div>
        </section>
</body>
</html>
